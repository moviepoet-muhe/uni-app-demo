"use strict";const e=require("../../common/vendor.js"),t=require("../../store/cart.js"),a=require("../../api/category.js"),o=require("../../api/home.js"),i={data:()=>({categories:[],banners:[],recommends:[],nextIndex:0,isEnd:!1}),async onLoad(){try{const e=await Promise.all([a.getAllCategories(),o.getHomeData()]);console.log("res:::",e),this.categories=e[0].list,this.banners=e[1].banners,this.recommends=e[1].items.list,this.nextIndex=e[1].items.nextIndex,this.isEnd=e[1].items.isEnd}catch(e){console.error("error:",e)}},onPullDownRefresh(){console.log("下拉刷新效果...")},async onReachBottom(){if(this.isEnd)console.log("全部数据查询完毕");else try{const e=await o.getMore(this.nextIndex);this.recommends=this.recommends.concat(e.list),this.nextIndex=e.nextIndex,this.isEnd=e.isEnd}catch(e){console.log("查询数据异常:::",e)}},methods:{...e.mapActions(t.useCartStore,{addToCart:"addToCart",remove:"removeFromCart"}),jumpToDetail(t){e.index.navigateTo({url:"/pages/detail/detail?id="+t})},jumpToCategory(t){getApp().globalData.categoryId=t,e.index.switchTab({url:"/pages/category/category"})},handleAddToCart(t){const{id:a,title:o,price:i,image:s}=t,n={id:a,title:o,price:i,image:s,amount:1};this.addToCart(n),e.index.showToast({title:"加入购物车成功!",duration:2e3})}}};if(!Array){e.resolveComponent("uni-search-bar")()}Math;const s=e._export_sfc(i,[["render",function(t,a,o,i,s,n){return e.e({a:e.p({placeholder:"请输入搜索关键字","cancel-text":"登录",cancelButton:"always"}),b:e.f(s.categories,((t,a,o)=>({a:e.t(t.name),b:t.id,c:e.o((e=>n.jumpToCategory(t.id)),t.id)}))),c:e.f(s.banners,((e,t,a)=>({a:e.image,b:e.id}))),d:e.f(s.recommends,((t,a,o)=>({a:t.image,b:e.o((e=>n.jumpToDetail(t.id)),t.id),c:e.t(t.title),d:"/pages/detail/detail?id="+t.id,e:e.t(t.price),f:e.o((e=>n.handleAddToCart(t)),t.id),g:t.id}))),e:!s.isEnd},(s.isEnd,{}))}],["__scopeId","data-v-1923443a"]]);wx.createPage(s);
